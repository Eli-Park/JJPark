communality <- apply(efa1$loadings**2, 1, sum) ; communality
efa2 <- factanal(cov=gov, factors=2,rotation="varimax")
communality <- apply(efa2$loadings**2, 1, sum) ; communality
corrplot(gov)
gov
summary(cfa1)
?sem
##################
# EXERCISE 6.6 ###
##################
library(sem)
model1 <- specifyModel()
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
cfa_att<-cfa(model1, sample.cov = AT, sample.nobs = 100)
corrplot(gov)
dimnames(gov) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
corrplot(gov)
#CFA
model1 <- specifyModel()
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
#model
cfa1 <- sem(model1, S=gov, N=100)
summary(cfa1)
cfa1
#model
cfa1 <- sem(model1, S=gov, N=100, optimizer=optimizerOptim)
summary(cfa1)
#Model
options(fit.indices=c("GFI", "AGFI", "RMSEA", "AIC", "BIC", "CAIC"))
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
#model
cfa1 <- sem(model1, S=gov, N=100, optimizer=optimizerOptim)
summary(cfa1)
cfa1
pathDiagram(cfa1, style="ram", ignore.double = FALSE, edge.labels="values")
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
)
gov
#model
cfa1 <- sem(model1, S=gov, optimizer=optimizerOptim)
#(c)
gov1 <- data.matrix(read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch06/GOVERNMENT_2.txt", fill =T, col.names = paste("X", 1:6)))
gov1[upper.tri(gov1)] <- t(gov1)[upper.tri(gov1)]
dimnames(gov1) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
gov1
cfa2 <- sem(model1, S=gov1, N=100)
summary(cfa2)
pathDiagram(cfa1, style="ram", ignore.double = FALSE, edge.labels="values")
#6.8
cog <- read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/COGNITION.txt", sep=" ")
?read.table
#6.8
cog <- read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/COGNITION.txt")
cog
cog <- cog[,-1]
cog
str(cog)
sum(cog==".")
for(i in 1:201){
cog[i,]==".")
}
for(i in 1:201){
cog[i,]=="."
}
for(i in 1:201){
print(cog[i,]==".")
}
temp<-numeric()
rows<-numeric()
temp<-0
rows<-numeric()
for(i in 1:201){
if(cog[i,]==".") {
temp <- temp+1
rows[temp] <- i
}
}
rows
temp
if(sum(cog[i,]==".")>0) {
temp <- temp+1
rows[temp] <- i
}
temp
sum(cog[12,]==".")>0
for(i in 1:201){
if(sum(cog[i,]==".")>=0) {
temp <- temp+1
rows[temp] <- i
}
}
temp
if(sum(cog[i,]==".")>=1) {
temp <- temp+1
rows[temp] <- i
}
temp<-0
rows<-numeric()
for(i in 1:201){
if(sum(cog[i,]==".")>=1) {
temp <- temp+1
rows[temp] <- i
}
}
temp
rows
cog <- cog[-rows,]
cog
#(a)
corrplot(cog)
corrplot(cor(cog))
for(i in 1:18){
cog[,i] <- as.numeric(cog[,i])
}
corrplot(cor(cog))
#(a)
cov_cog <- cov(cog)
cov_cog
dimnames(cov_cog) <- list(paste("X", 1:18, sep = ""),paste("X", 1:18, sep = ""))
cov_cog
corrplot(cor(cov_cog))
A1 -> X1, lam1, NA
A1 -> X2, lam1, NA
model1 <- specifyModel()
pathDiagram(cfa2, style="ram", ignore.double = FALSE, edge.labels="values")
#model test
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
model1 <- specifyModel()
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
pathDiagram(cfa1, style="ram", ignore.double = FALSE, edge.labels="values")
pathDiagram(cfa3, style="ram", ignore.double = FALSE, edge.labels="values")
cfa3$coeff
b<-sum(cfa3$coeff[19:36])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
a<-sum(cfa3$coeff[1:18])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
pc2
#(b)
solve(cor(cog))%*%diag(cfa3$coeff[1:18])
#(b)
solve(cor(cog))%*%(cfa3$coeff[1:18])
#(b)
solve(cor(cov_cog))%*%(cfa3$coeff[1:18])
#(b)
solve(cor(cog))%*%t(cfa3$coeff[1:18])
t(cfa3$coeff[1:18])
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cor(cog)
cor(cov_cog)
#(b)
solve(cor(cov_cog))%*%matrix(cfa3$coeff[1:18],18,1)
cor(cov_cog)
solve(cor(cov_cog))
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cfa3$coeff[1:18]
# 6.1
lam<-c(0.725,0.65,0.58,0.605,0.81)
theta<-c(.474,.578,.664,.634,.344)
sum(lam^2)/(sum(lam^2)+sum(theta^2))
# 6.2
lam <- c(0.78, 0.69, 0.73, 0.75, 0.84, 0.72)
corr <- 0.36
#(a)
lam[2]*corr*lam[5]
# 6.4
AT <- data.matrix(read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch06/ATTITUDE.txt", fill =T, col.names = paste("X", 1:6)))
AT[upper.tri(AT)] <- t(AT)[upper.tri(AT)]
dimnames(AT) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
AT
#(A)
library("sem")
model1 <- specifyModel()
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
library("DiagrammeR")
pathDiagram(cfa1, style="ram", ignore.double = FALSE, edge.labels="values")
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("a", "b", "c"))
pathDiagram(cfa1, style="ram", ignore.double = FALSE, edge.labels="values")
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.err","X2.err","X3.err","X4.err","X5.err","X6.err"))
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.error","X2.error","X3.error","X4.error","X5.error","X6.error"))
#(b)
library("sem")
model1 <- specifyModel()
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.error","X2.error","X3.error","X4.error","X5.error","X6.error"))
#(b)
library("sem")
model1 <- specifyModel()
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.error","X2.error","X3.error","X4.error","X5.error","X6.error"))
#(c)
model1 <- specifyModel()
options(fit.indices=c("GFI", "AGFI", "RMSEA", "AIC", "BIC", "CAIC"))
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.error","X2.error","X3.error","X4.error","X5.error","X6.error"))
qchisq(0.05,3)
qchisq(0.95,3)
#(d)
pca1 <- princomp(cov=AT, retx=T, center=T, scale.=T)
pca1
summary(pca1)
plot(pca1$sdev, type ="b", main="Scree plot", xlab = "Factors", ylab = "Eigen Value")
abline(h=1, col = "red")
loading <- eg$vectors%*%sqrt(diag(eg$values))
loading[,1:2]
##6.6
gov <- data.matrix(read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/GOVERNMENT_1.txt", fill =T, col.names = paste("X", 1:6)))
gov[upper.tri(gov)] <- t(gov)[upper.tri(gov)]
dimnames(gov) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
corrplot(gov)
#PCA
X <- as.matrix(gov)
pca.gov <- eigen(X)
t(eigen(X)$vectors)%*%eigen(X)$vectors
round(pca.gov$values, 2)
loadings.gov <- pca.gov$vectors %*% sqrt(diag(pca.gov$values))
apply(round(loadings.gov,2)**2, 2, sum)
cm.2.gov <- apply(loadings.gov[,1:2]**2, 2, sum)
sum(round(cm.2.gov, 2))/6
pca <- princomp(covmat = X)
summary(pca)
plot(pca$sdev**2, type ="b", main="Scree plot", xlab = "Factors", ylab = "Eigen Value")
abline(h=1, col = "red")
#EFA
efa1 <- factanal(cov=gov, factors=3,rotation="varimax")
communality <- apply(efa1$loadings**2, 1, sum) ; communality
efa2 <- factanal(cov=gov, factors=2,rotation="varimax")
communality <- apply(efa2$loadings**2, 1, sum) ; communality
summary(efa2)
efa2 <- factanal(cov=gov, factors=2,rotation="varimax")
summary(efa2)
efa2
communality <- apply(efa2$loadings**2, 1, sum) ; communality
#CFA
model1 <- specifyModel()
cfa1 <- sem(model1, S=gov, N=100, optimizer=optimizerOptim)
summary(cfa1)
cfa1
pathDiagram(cfa1, style="traditional",
ignore.double = FALSE, error.nodes = TRUE,
edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.error","X2.error","X3.error","X4.error","X5.error","X6.error"))
loadings.gov <- pca.gov$vectors %*% sqrt(diag(pca.gov$values))
loadings.gov
#(c)
gov1 <- data.matrix(read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch06/GOVERNMENT_2.txt", fill =T, col.names = paste("X", 1:6)))
gov1[upper.tri(gov1)] <- t(gov1)[upper.tri(gov1)]
dimnames(gov1) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
cfa2 <- sem(model1, S=gov1, N=100)
summary(cfa2)
#6.8
cog <- read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/COGNITION.txt")
cog <- cog[,-1]
temp<-0
rows<-numeric()
for(i in 1:201){
if(sum(cog[i,]==".")>=1) {
temp <- temp+1
rows[temp] <- i
}
}
cog <- cog[-rows,]
for(i in 1:18){
cog[,i] <- as.numeric(cog[,i])
}
#(a)
cov_cog <- cov(cog)
dimnames(cov_cog) <- list(paste("X", 1:18, sep = ""),paste("X", 1:18, sep = ""))
corrplot(cor(cov_cog))
model1 <- specifyModel()
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
pathDiagram(cfa3, style="ram", ignore.double = FALSE, edge.labels="values")
a<-sum(cfa3$coeff[1:18])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
pc2
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cfa3$coeff[1:18]
getwd()
na <- read.csv("na.csv")
setwd("C:/Users/pkmon/Desktop/생과데 과제3")
na <- read.csv("na.csv")
na
#5-3
na.fit <- lm(Y ~ X*med, data=na)
na.anco <- Anova(na.fit,type="III")
install.packages(("car"))
library("car")
na.anco <- Anova(na.fit,type="III")
na.anco
na.anco.r <- Anova(na.fit.r,type="III")
na.fit.r <- lm(y~ x+ trt, data=na)
na.anco.r <- Anova(na.fit.r,type="III")
na.fit.r <- lm(Y~ X + med, data=na)
na.anco.r <- Anova(na.fit.r,type="III")
na,anco.r
na.anco.r
lsmeans(na.fit.r,"med")
library("lsmeans")
install.packages("lsmeans")
library("lsmeans")
lsmeans(na.fit.r,"med")
baka <- read.csv("baka")
baka <- read.csv("baka.csv")
#5-5
head(baka)
#5-5
str(baka)
baka$temp <- as.factor(baka$temp)
baka.fit <- lm(growth ~ water*temp + fert*temp, data=baka)
baka.anco <- Anova(baka.fit,type="III")
baka.anco
baka.anco.r <- Anova(baka.fit.r,type="III")
baka.fit.r <- lm(growth ~ temp + water + fert, data=baka)
baka.anco.r <- Anova(baka.fit.r,type="III")
baka.anco.r
lsmeans(baka.fit.r,"temp")
study <- read.csv("study.csv")
#5-7
str(study)
study.fit <- lm(ach ~ meth + inte + mot + method*inte + meth*mot , data=study)
study.fit <- lm(ach ~ meth + inte + mot + meth*inte + meth*mot , data=study)
study.ano <- anova(model1)
study.ano <- anova(study.fit)
summary(study.ano)
study.ano
study.fit.r <- lm(ach ~ meth + inte +mot, data=study)
study.ano
study.ano <- anova(study.fit, type="3")
study.ano <- anova(study.fit, type="III")
study.ano <- Anova(study.fit, type="III")
study.ano
study.ano <- Anova(study.fit)
study.ano
study.ano <- Anova(study.fit, type="III")
study.ano
study.anco <- Anova(study.fit.r, type"III")
study.fit.r <- lm(ach ~ meth + inte +mot, data=study)
study.anco <- Anova(study.fit.r, type"III")
study.anco <- Anova(study.fit.r, type="III")
study.anco.r <- Anova(study.fit.r, type="III")
study.anco.r
model2 <- lm(ach ~ meth + inte +mot, data=study)
G1 <- anova(model2)
G1
model3 <- lm(ach ~ meth1 + meth2 + inte +mot, data=study)
library(dummy)
?dummy
study1 <- dummy(meth, data = study)
?dummy
study1 <- dummy(meth)
study1 <- dummy(study$meth)
study1
letters <- c( "a", "a", "b", "c", "d", "e", "f", "g", "h", "b", "b" )
dummy( as.character(letters) )
dummy( letters[1:6] )
study1 <- dummy(study)
study1
study.fit.r <- lm(ach ~ meth + inte +mot, data=study)
study.fit.r
study.anco.r <- Anova(study.fit.r, type="III")
study.fit.r
a <- aov(study.fit.r)
a
summary(a)
lsmeans(baka.fit.r,"temp")
baka.fit.r <- lm(growth ~ temp + water + fert, data=baka)
baka.anco.r <- Anova(baka.fit.r,type="III")
baka.anco.r
study.fit.r <- lm(ach ~ meth + inte +mot, data=study)
study.fit.r
lsmeans(study.fit.r,"ach")
study.fit.r <- lm(ach ~ meth + inte +mot, data=study)
study.anco.r <- Anova(study.fit.r, type="III")
study.fit.r
lsmeans(study.fit.r,"ach")
lsmeans(study.fit.r, "ach")
lsmeans(baka.fit.r,"temp")
lsmeans(study.fit.r, "meth")
study.fit.r
a <- aov(study.fit.r)
summary(a)
a$coefficients
study.anco.r <- Anova(study.fit.r, type="III")
study.anco.kr
study.anco.r
mean(baka$water)
mean(baka$fert)
6.552450839-0.822936395+0.054526734*24.90833-0.145957320*14.63889
library("car")
library("lsmeans")
setwd("C:/Users/pkmon/Desktop/생과데 과제3")
na <- read.csv("na.csv")
baka <- read.csv("baka.csv")
study <- read.csv("study.csv")
#5-3
na.fit <- lm(Y ~ X*med, data=na)
na.anco <- Anova(na.fit,type="III")
na.anco
na.fit.r <- lm(Y~ X + med, data=na)
na.anco.r <- Anova(na.fit.r,type="III")
na.anco.r
na.fit.r
lsmeans(na.fit.r,"med")
mean(na$X)
baka.fit <- lm(growth ~ water*temp + fert*temp, data=baka)
baka.anco <- Anova(baka.fit,type="III")
baka.anco
baka$temp <- as.factor(baka$temp)
baka.fit <- lm(growth ~ water*temp + fert*temp, data=baka)
baka.anco <- Anova(baka.fit,type="III")
baka.anco
baka.fit.r <- lm(growth ~ temp + water + fert, data=baka)
baka.anco.r <- Anova(baka.fit.r,type="III")
baka.anco.r
baka.fit.r
mean(baka$water, baka$fert)
baka.fit.r
lsmeans(baka.fit.r,"temp")
c(mean(baka$water),mean(baka$fert))
?lsmeans
lsmeans(baka.fit.r,"temp", adjust = "bonferroni")
lsmeans(baka.anco.kr,
~ temp,
adjust="tukey")
lsmeans(baka.anco.r,
~ temp,
adjust="tukey")
lsmeans(baka.fit,
~ temp,
adjust="tukey")
lsmeans(baka.fit.r,
~ temp,
adjust="tukey")
a<-lsmeans(baka.fit.r,
~ temp,
adjust="tukey")
a$contrast
str(A)
str(a)
model = clm(growth ~ temp + water + fert,
data = baka)
library("ordinal")
install.packages("ordinal")
library("ordinal")
model = clm(growth ~ temp + water + fert, data = baka)
model = clm(growth ~ temp, data = baka)
contrast(a, alpha=0.05, method="pairwise", adjust=NULL)
lsm<-lsmeans(baka.fit.r,"temp", adjust = "bonferroni")
contrast(lsm, alpha=0.05, method="pairwise", adjust=NULL)
study.fit <- lm(ach ~ meth + inte + mot + meth*inte + meth*mot , data=study)
study.ano <- Anova(study.fit, type="III")
study.ano
study.fit.r <- lm(ach ~ meth + inte +mot, data=study)
study.anco.r <- Anova(study.fit.r, type="III")
study.anco.r
study.fit.r
a$coefficients
a <- aov(study.fit.r)
a$coefficients
summary(a)
study.fit.r
