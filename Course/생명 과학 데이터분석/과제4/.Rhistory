edge.labels="values",
min.rank=c("A1", "A2"),
same.rank=c("X1", "X2", "X3", "X4", "X5", "X6"),
max.rank=c("X1.error","X2.error","X3.error","X4.error","X5.error","X6.error"))
loadings.gov <- pca.gov$vectors %*% sqrt(diag(pca.gov$values))
loadings.gov
#(c)
gov1 <- data.matrix(read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch06/GOVERNMENT_2.txt", fill =T, col.names = paste("X", 1:6)))
gov1[upper.tri(gov1)] <- t(gov1)[upper.tri(gov1)]
dimnames(gov1) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
cfa2 <- sem(model1, S=gov1, N=100)
summary(cfa2)
#6.8
cog <- read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/COGNITION.txt")
cog <- cog[,-1]
temp<-0
rows<-numeric()
for(i in 1:201){
if(sum(cog[i,]==".")>=1) {
temp <- temp+1
rows[temp] <- i
}
}
cog <- cog[-rows,]
for(i in 1:18){
cog[,i] <- as.numeric(cog[,i])
}
#(a)
cov_cog <- cov(cog)
dimnames(cov_cog) <- list(paste("X", 1:18, sep = ""),paste("X", 1:18, sep = ""))
corrplot(cor(cov_cog))
model1 <- specifyModel()
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
pathDiagram(cfa3, style="ram", ignore.double = FALSE, edge.labels="values")
a<-sum(cfa3$coeff[1:18])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
pc2
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cfa3$coeff[1:18]
time7_2 = c(0:15 , NA)
death7_2 = c(82,30,27,22,26,25,20,11,14,13,5,5,5,2,3,3)
censor7_2 = c(0,8,8,7,7,28,31,32,24,27,22,23,18,9,7,11)
sur7_2 = lifetab(tis = time7_2 , ninit = 555 , nlost = censor7_2, nevent = death7_2)
install.packages("KMsurv")
library(KMsurv)
plot(stepfun(x=1:15, y = sur7_2$surv) , pch="", main = "Survival Curve of ex7_2",
ylab = "Survival Probability", xlab="Time")
sur7_2 = lifetab(tis = time7_2 , ninit = 555 , nlost = censor7_2, nevent = death7_2)
sur7_2
plot(stepfun(x=1:15, y = sur7_2$surv) , pch="", main = "Survival Curve of ex7_2",
ylab = "Survival Probability", xlab="Time")
#7-3
time7.3 = c(2,4,5,10,10,12,12,14,14,15,16,18,19,23,25,26,27,30,31,34,35,37,38,39,42,43,46,47,49,50,53,54)
censor7.3 = c(1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,1,2,1,1,2,2,1,2,1,1,2,2)
so7.3 = Surv(time7.3,censor7.3==1)
survival7.3 = survfit(so7.3~1)
plot(survival7.3 , conf.int = F, mark=1 , main = "Survival Curve of ex7.3")
legend(45,1 , legend="censored", pch=1)
install.packages("survival")
library(survival)
censor7.3 = c(1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,1,2,1,1,2,2,1,2,1,1,2,2)
so7.3 = Surv(time7.3,censor7.3==1)
survival7.3 = survfit(so7.3~1)
plot(survival7.3 , conf.int = F, mark=1 , main = "Survival Curve of ex7.3")
legend(45,1 , legend="censored", pch=1)
abline(h=0.5, v=31, lty=2, col=2)
summary(survival7.3)
#7-4
time7.4 = c(1,2,5,5,5,7,9,11,11,13,13,16,20,21,22,22,31,33,37,43,
1,3,4,4,5,7,7,9,9,14,17,19,27,30,41)
censor7.4 = c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,1,
1,1,1,1,1,1,1,1,1,2,1,2,2,2,2)
group7.4 = c(rep("A",20) , rep("B",15))
data7.4 = data.frame(time7.4 , censor7.4 , group7.4)
so7.4 = Surv(time7.4 , censor7.4==1)
survival7.4 = survfit(so7.4~group7.4)
plot(survival7.4, lty=c(1,2) , mark=1 , main = "Survival time of ex7.4" , xlab="time"
,ylab="survival distribution function")
legend(35,1.0 , legend=c("A","B"), lty=c(1,2) , title="Group", bty="n")
legend(35,0.75 , legend="censored" , pch=1, bty="n")
survdiff(so7.4~group7.4)
#7-6
time7_6 = c(18,9,28,31,39,19,45,6,8,15,23,28,7,12,9,8,2,26,10,4,3,4,18,8,3,14,3,13,13,35)
censor7_6 = c(1,1,2,1,2,2,2,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2)
sur7_6 = Surv(time7_6, censor7_6==1)
age7_6 = c(rep(0,13),rep(1,17))
marrow7_6 = c(0,1,0,1,1,1,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,1,1,1,0,1,1,0)
coxph(sur7_6~age7_6+marrow7_6, method="breslow")
#7-6
time7_6 = c(18,9,28,31,39,19,45,6,8,15,23,28,7,12,9,8,2,26,10,4,3,4,18,8,3,14,3,13,13,35)
censor7_6 = c(1,1,2,1,2,2,2,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2)
sur7_6 = Surv(time7_6, censor7_6==1)
age7_6 = c(rep(0,13),rep(1,17))
marrow7_6 = c(0,1,0,1,1,1,1,1,1,1,0,0,1,0,0,0,1,0,1,0,0,0,1,1,1,1,0,1,1,0)
coxph(sur7_6~age7_6+marrow7_6, method="breslow")
?coxph
S <- 50
N <- 50
R <- 0.005
U <- 0.01
D <- -0.01
X <- 60
m <- 35
p <- (R-D)/(U-d)
p <- (R-D)/(U-D)
p
q <- p*((1+U)/1+R))
q <- p*((1+U)/(1+R))
q
a <- numeric()
a <- 0
?choose
a <- 0
for(i in m:N) {
a <- a+ S*choose(N,i)*(q^i)*((1-q)^(N-i)) -(((1+R)^(-N))*X*choose(N,i)*(q^i)*((1-q)^(N-i)))
}
a
a <- function(m, N, p) {
b<-0
for(i in m:N){
b <- b+choose(N,i)*(p^i)*((1-p)^(N-i))
}
return(b)
}
S*(1-a(m-1,N,q))-((1+R)^(-N))*X*(1-a(m-1,N,p))
for(i in m:N) {
a <- a+ S*choose(N,i)*(q^i)*((1-q)^(N-i)) -(((1+R)^(-N))*X*choose(N,i)*(p^i)*((1-p)^(N-i)))
}
a <- 0
for(i in m:N) {
a <- a+ S*choose(N,i)*(q^i)*((1-q)^(N-i)) -(((1+R)^(-N))*X*choose(N,i)*(p^i)*((1-p)^(N-i)))
}
a
S*(1-a(m,N,q))-((1+R)^(-N))*X*(1-a(m,N,p))
a <- function(m, N, p) {
b<-0
for(i in m:N){
b <- b+choose(N,i)*(p^i)*((1-p)^(N-i))
}
return(b)
}
S*(1-a(m,N,q))-((1+R)^(-N))*X*(1-a(m,N,p))
a <- 0
for(i in m:N) {
a <- a+ S*choose(N,i)*(q^i)*((1-q)^(N-i)) -(((1+R)^(-N))*X*choose(N,i)*(p^i)*((1-p)^(N-i)))
}
a
q
S
#7-5
library("flexsurv")
data <- read.csv("dia.csv")
time <- data$time
cens <- data$censor
surfit <- Surv(time , cens==1)
time <- data$time
cens <- data$censor
surfit <- Surv(time , cens==1)
time
data <- read.csv("dia.csv")
setwd("C:/Users/pkmon/Desktop/생과데 과제4")
data <- read.csv("dia.csv")
time <- data$time
cens <- data$censor
surfit <- Surv(time , cens==1)
time
summary(sur)
S <- sur$surv
summary(surfit)
surfit
summary(surfit)
fs1
fs1 <- flexsurvreg(surfit ~ age + BMI + dage + smoke, data = data, dist = "weibull")
fs1
sur <- survfit(surfit~1)
S <- sur$surv
S
plot(x=log(time), y=-log(S))
-log(s)
-log(S)
#지수
S
#지수
S[-25]
#지수
S<-S[-25]
plot(x=log(time), y=-log(S))
time
log(-log(S))
qnorm(1-S)
time1 <- unique(time)
time1
time1 <- sort(time)
time1
unique(time1)
length(unique(time1))
time1<-unique(time1)
S <- sur$surv
plot(x=log(time1), y=-log(S))
library(ggplot)
library(ggplot2)
time <- data$time
cens <- data$censor
surfit <- Surv(time , cens==1)
sur <- survfit(surfit~1)
S <- sur$surv
time<-unique(sort(time))
#지수
ggplot(aes(x=log(time),y=-log(S))) +
geom_line()
plot(x=log(time),y=-log(S))
#지수
ggplot(aes()) +
geom_line()
#지수
ggplot(aes()) +
geom_line(aes(x=log(time), y=-log(S)))
#지수
ggplot(data=data, aes()) +
geom_line(aes(x=log(time), y=-log(S)))
plot(x=log(time),y=-log(S))
abline(x=log(time),y=-log(S))
data1 <- cbind(S, -log(S), log(-log(S)), qnorm(1-S), log((1-S)/S), log(time))
data1
data1 <- cbind(S=S, logs=-log(S), weibul=log(-log(S)), lognorm=qnorm(1-S), loglogit=log((1-S)/S), logt=log(time))
data1
#지수
ggplot2(data1, aes(x=logt, y=logs))+
geom_line
library(ggplot2)
#지수
ggplot2(data1, aes(x=logt, y=logs))+
geom_line
#지수
ggplot(data1, aes(x=logt, y=logs))+
geom_line
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line
data1 <- as.data.frame(data1)
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line()+
geom_point()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(linetype=3)+
geom_point()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(linetype=5)+
geom_point()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(linetype=5, col="blue")+
geom_point()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(linetype=5, size=3, col="blue")+
geom_point()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2)
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, col="red")
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, col="red")+
geom_tile("지수분포")
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, col="red", fill="white")+
geom_tile()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, fill="white")+
geom_tile()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, col="white")+
geom_tile()
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, col="white")+
ggtile("지수분포")
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=2, col="white")+
ggtitle("지수분포")
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("지수분포")
?ggtitle
#지수
ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("지수분포")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#와이블
ggplot(data=data1, aes(x=logt, y=weibul))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("와이블")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
install.packages("gridExtra")
library(gridExtra)
#로그-정규분포
p3<-ggplot(data=data1, aes(x=logt, y=lognorm))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("로그정규")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-로지스틱
p4<-ggplot(data=data1, aes(x=logt, y=loglogit))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("로그 로지스틱")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
ㅔ4
p4
p3
grid.arrange(p1,p2,p3,p4, nrow=2, ncol=2)
#지수
p1<-ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("지수분포")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#와이블
p2<-ggplot(data=data1, aes(x=logt, y=weibul))+
geom_line(size=2, col="blue")+
geom_point(size=3, col="skyblue")+
ggtitle("와이블")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
grid.arrange(p1,p2,p3,p4, nrow=2, ncol=2)
#지수
p1<-ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("지수분포")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#와이블
p2<-ggplot(data=data1, aes(x=logt, y=weibul))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("와이블")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-정규분포
p3<-ggplot(data=data1, aes(x=logt, y=lognorm))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("로그정규")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-로지스틱
p4<-ggplot(data=data1, aes(x=logt, y=loglogit))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("로그 로지스틱")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
grid.arrange(p1,p2,p3,p4, nrow=2, ncol=2)
#와이블 분포
fs1 <- flexsurvreg(surfit ~ age + BMI + dage + smoke, data = data, dist = "weibull")
fs1
summary(fs1)
fs1
fs1$dlist
fs1
survreg(surfit ~ age + BMI + dage + smoke, data = data, dist = "weibull")
A<-survreg(surfit ~ age + BMI + dage + smoke, data = data, dist = "weibull")
summary(A)
A<-survreg(surfit ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
#와이블 분포
fs1 <- flexsurvreg(surfit ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
fs1
summary(A)
surfit
surfit <- Surv(time , cens==0)
time <- data$time
cens <- data$censor
surfit <- Surv(time , cens==1)
A<-survreg(surfit ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
surfit <- Surv(time , cens==0)
A<-survreg(surfit ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
1
surfit <- Surv(time , cens==1)
sur <- survfit(surfit~1)
S <- sur$surv
summary(A)
A<-survreg(surfit ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
data
A<-survreg(Surv(time, censor) ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
data <- read.csv("dia.csv")
data
time <- data$time
cens <- data$censor
A<-survreg(Surv(time, censor) ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
#7-5
library("flexsurv")
data <- read.csv("dia.csv")
data
time <- data$time
cens <- data$censor
surfit <- Surv(time , cens==1)
sur <- survfit(surfit~1)
S <- sur$surv
time<-unique(sort(time))
data1 <- cbind(S=S, logs=-log(S), weibul=log(-log(S)), lognorm=qnorm(1-S), loglogit=log((1-S)/S), logt=log(time))
data1 <- as.data.frame(data1)
library(ggplot2)
library(gridExtra)
data1 <- cbind(S=S, logs=-log(S), weibul=log(-log(S)), lognorm=qnorm(1-S), loglogit=log((1-S)/S), logt=log(time), time=time)
data1 <- as.data.frame(data1)
#지수
p1<-ggplot(data=data1, aes(x=time, y=logs))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("지수분포")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#와이블
p2<-ggplot(data=data1, aes(x=logt, y=weibul))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("와이블")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-정규분포
p3<-ggplot(data=data1, aes(x=logt, y=lognorm))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("로그정규")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-로지스틱
p4<-ggplot(data=data1, aes(x=logt, y=loglogit))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("로그 로지스틱")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
grid.arrange(p1,p2,p3,p4, nrow=2, ncol=2)
#지수
p1<-ggplot(data=data1, aes(x=logt, y=logs))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("지수분포")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
grid.arrange(p1,p2,p3,p4, nrow=2, ncol=2)
#지수
p1<-ggplot(data=data1, aes(x=time, y=logs))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("지수분포")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#와이블
p2<-ggplot(data=data1, aes(x=logt, y=weibul))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("와이블")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-정규분포
p3<-ggplot(data=data1, aes(x=logt, y=lognorm))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("로그정규")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
#로그-로지스틱
p4<-ggplot(data=data1, aes(x=logt, y=loglogit))+
geom_line(size=1, col="blue")+
geom_point(size=2, col="skyblue")+
ggtitle("로그 로지스틱")+
theme(plot.title = element_text(family = "serif", face = "bold", hjust = 0.5, size = 15, color = "darkblue"))
grid.arrange(p1,p2,p3,p4, nrow=2, ncol=2)
#와이블 분포
time <- data$time
cens <- data$censor
A<-survreg(Surv(time, censor) ~ age + BMI + dage + factor(smoke), data = data, dist = "weibull")
summary(A)
-22.6056286+26.44865482
2*(-22.6056286+26.44865482)
a<-2*(-22.6056286+26.44865482)
qchisq(a, 4)
qchisq(0.95, 4)
qchisq(0.9, 4)
qchisq(0.95, 4)
