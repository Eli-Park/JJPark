X1 <- X1[-50,2:14] #Delete Wyoming
X1 <- X1[-2,] #Delete Alaska
X1 <- as.matrix(X1)
corX1 <- cor(X1)
pca.share1 <- eigen(corX1)
round(pca.share1$values, 2)
round(pca.share1$values/sum(pca.share1$values), 2)
#(b)
X1 <- share
dimnames(X1) <-list(share[,1], c("Agriculture", "Mining", "Construction", "MFR_DUR", "MFR_NON", "Transport", "Commun", "Utilities"
,"Wholesale", "Retail", "Fiduciary", "Services", "Gov"))
#(b)
X1 <- X
X1 <- X1[-50,2:14] #Delete Wyoming
X1 <- X1[-2,] #Delete Alaska
#(b)
X1 <- X
X1
str(X1)
X1 <- X1[-50,] #Delete Wyoming
X1 <- X1[-2,] #Delete Alaska
corX1 <- cor(X1)
pca.share1 <- eigen(corX1)
round(pca.share1$values, 2)
round(pca.share1$values/sum(pca.share1$values), 2)
plot(c(1:13), pca.share1$values, type = "b", main="Scree Plot", xlab="component number", ylab = "Eigenvalues")
abline(h=1, col = "red")
loadings.share1 <- pca.share1$vectors %*% sqrt(diag(pca.share1$values))
round(loadings.share1, 2)
pcashare1 <- prcomp(X1, retx=T, center=T, scale. = T)
summary(pcashare1)
plot(c(1:13), pcashare1$sdev**2, type = "b", main="Scree Plot", xlab="component number", ylab = "Eigenvalues")
abline(h=1, col="red") #5번째 factor 까지 사용하는 것이 좋아보임
autoplot(pcashare1, data = X1, loadings = TRUE, loadings.label=TRUE, label = TRUE)
loadings.share <- pca.share$vectors %*% sqrt(diag(pca.share$values)) #loadings
round(loadings.share, 2)
apply(round(loadings.share, 2)**2, 2, sum)
pcashare$loadings
loadings.gov <- pca.gov$vectors %*% sqrt(diag(pca.gov$values))
round(loadings.gov,2)
X <- as.matrix(gov)
pca.gov <- eigen(X)
round(pca.gov$values, 2)
loadings.gov <- pca.gov$vectors %*% sqrt(diag(pca.gov$values))
round(loadings.gov,2)
pca <- princomp(covmat = X)
summary(pca)
round(cumsum(pca.gov$values/sum(pca.gov$values)), 2)
var = eigen(X)$vectors
var
plot(var, type ="b", main="Scree plot", xlab = "Factors", ylab = "Eigen Value")
abline(h=1, col = "red")
pca$loadings
pca.gov$vectors
round(pca.gov$values, 2)
#5
X <- iris
X$V1 <- as.factor(X$V1)
colnames(X) <- c("species","sepal length", "sepal width", "petal length", "petal width")
#(a)
pairs(X[,2:5])
X <- as.matrix(X[2:5])
head(X)
corX <- cor(X)
corX
pca.iris <- prcomp(X, retx=T, center=T, scale.=T)
summary(pca.iris)
plot(var, type ="b", main="Scree plot", xlab = "Factors", ylab = "Eigen Value")
abline(h=1, col = "red")
summary(pca.iris)
autoplot(pcairis)
autoplot(pca,iris,  data = X1, loadings = TRUE, loadings.label=TRUE, label = TRUE)
autoplot(pca.iris,  data = X1, loadings = TRUE, loadings.label=TRUE, label = TRUE)
pca.iris <- prcomp(X, retx=T, center=T, scale.=T)
pca.iris <- princomp(X, retx=T, center=T, scale.=T)
summary(pca.iris)
autoplot(pca.iris,  data = X1, loadings = TRUE, loadings.label=TRUE, label = TRUE)
corX
X
pca.iris <- princomp(X, retx=T, center=T, scale.=T)
corX
pca.iris <- princomp(X, retx=T, center=T, scale.=T)
summary(pca.iris)
autoplot(pca.iris,  data = X, loadings = TRUE, loadings.label=TRUE, label = TRUE)
autoplot(pca.iris,  data = X, loadings = TRUE, loadings.label=TRUE)
scores <- as.data.frame(cbind(species=iris[,1], pca.iris$x))
mscores <- aggregate(scores[,2:5], list(scores$species), mean)
scores <- as.data.frame(cbind(species=iris[,1], pca.iris$x))
mscores <- aggregate(scores[,2:5], list(scores$species), mean)
scores <- as.data.frame(cbind(species=iris[,1], pca.iris$scores))
mscores <- aggregate(scores[,2:5], list(scores$species), mean)
plot(mscores[,2], mscores[,3], xlab = "First PC", ylab="Second PC")
text(mscores[,2], mscores[,3], labels = mscores[,1])
var <- eigen(corX)$values
rot <- eigen(corX)$vectors
apply((rot%*%diag(sqrt(var)))^2, 2, sum)
iris1 <- iris
iris1[,2:5] <- pca.iris$x
autoplot(pca.iris, X, loadings = TRUE, loadings.label=TRUE, labels = TRUE)
attach(mscores)
plot(scores$PC1, scores$PC2)
mscores
plot(scores$Comp.1, scores$Comp.2)
points(PC1, PC2, col="red", pch=10)
points(Comp.1, Comp.2, col="red", pch=10)
points(Comp.1, Comp.2, col="red", pch=16)
#(a)
pairs(X[,2:5])
X <- as.matrix(X[2:5])
#5
X <- iris
X$V1 <- as.factor(X$V1)
colnames(X) <- c("species","sepal length", "sepal width", "petal length", "petal width")
#(a)
pairs(X[,2:5])
X <- as.matrix(X[2:5])
pca.voc$loadings
pca.voc <- princomp(cov = voc)
summary(pca.voc)
plot(1:22, pca.voc$sdev**2, type ="b", main="Scree plot", xlab = "Factors", ylab = "Eigen Value")
abline(h=1, col = "red")
pca.voc$loadings
pca.voc <- princomp(cov = voc)
summary(pca.voc)
pca.voc$loadings
m <- round(pca.voc$loadings[,1:6],3)
m
voc
eigen(voc)$vectors%*%sqrt(diag(digen(voc)$value))
eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value))
round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
eigen(voc)$value^2
eigen(voc)$value^2/sum(eigen(voc)$value^2)
round(eigen(voc)$value^2/sum(eigen(voc)$value^2),2)
voc
summary(pca.voc)
plot(1:22, pca.voc$sdev**2, type ="b", main="Scree plot", xlab = "Factors", ylab = "Eigen Value")
abline(h=1, col = "red")
pca.voc$loadings
ms
ms <- abs(m)>0.25
ms
plot(pca.voc$loadings[,1], pca.voc$loadings[,2])
text(pca.voc$loadings[,1], pca.voc$loadings[,2], labels = rownames(pca.voc$loadings))
abline(h=0, v=0)
X <- as.matrix(gov)
pca.gov <- eigen(X)
round(pca.gov$values, 2)
loadings.gov <- pca.gov$vectors %*% sqrt(diag(pca.gov$values))
round(loadings.gov,2)
pca.gov$vectors
round(cumsum(pca.gov$values/sum(pca.gov$values)), 2)
pcagov <- princomp(cov=X)
pcagov$loadings
?princomp
t(eigen(X)$vectors)%*%eigen(X)$vectors
summary(pca.iris)
pca.iris$loadings
autoplot(pca.iris,  data = X, loadings = TRUE, loadings.label=TRUE)
round(loadings.gov,2)
apply(round(loadings.gov,2)**2, 2, sum)
pcagov$loadings
pcagov <- princomp(cov=X)
pcagov
X <- as.matrix(gov)
pca.gov <- eigen(X)
pcagov <- princomp(cov=X)
pcagov
pcagov$loadings
pcagov$sdev
pcagov <- prcomp(cov=X)
pcagov
?prcomp
round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
round(eigen(voc)$value^2/sum(eigen(voc)$value^2),2)
summary(pca.voc)
pca.voc <- princomp(cov = voc)
pca.voc
pca.voc$loadings
round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
pca.voc$loadings
share <- read.table("C:/Users/pkmon/Desktop/다변량1/DATA/GSP_SHARE.txt")
raw <- read.table("C:/Users/pkmon/Desktop/다변량1/DATA/GSP_RAW.txt")
gov <- data.matrix(read.table("C:/Users/pkmon/Desktop/다변량1/DATA/Ch04/GOVERNMENT_1.txt", fill =T, col.names = paste("X", 1:6)))
gov[upper.tri(gov)] <- t(gov)[upper.tri(gov)]
iris <- read.table("C:/Users/pkmon/Desktop/다변량1/DATA/Ch04/IRIS.txt")
voc <- data.matrix(read.table("C:/Users/pkmon/Desktop/다변량1/DATA/Ch04/VOCATIONS.txt", fill =T, col.names = paste("X", 1:22)))
voc[upper.tri(voc)] <- t(voc)[upper.tri(voc)]
rec <- read.table("C:/Users/pkmon/Desktop/다변량1/DATA/Ch04/RECORDS.txt")
drug <- data.matrix(read.table("C:/Users/pkmon/Desktop/다변량1/DATA/Ch04/DRUG_USE.txt", fill =T, col.names = paste("X", 1:13)))
drug[upper.tri(drug)] <- t(drug)[upper.tri(drug)]
pca <- prcomp(cov = X)
pca <- prcomp(covmat = X)
X <- as.matrix(gov)
X
voca <- X
voca_u<-eigen(voca)$vectors
voca_lam<-eigen(voca)$values
voca_lam
plot(voca_lam, type="l")
points(voca_lam)
loadings_voca<-voca_u%*%diag(sqrt(voca_lam))
loadings_voca
redim<-voca_u[,1:7]
redim
redim<-voca_u[,1:7]
voca_u
a<-loadings_voca[,1:6]
redim<-voca_u[,1:6]
redim
a<-loadings_voca[,1:6]
plot(a[,2]~a[,1], xlim=c(-1, 0.5), col=1)
abline(v=0, h=0)
points(a[,3]~a[,1], col=2)
points(a[,4]~a[,1], col=3)
points(a[,5]~a[,1], col=4)
points(a[,6]~a[,1], col=5)
points(a[,7]~a[,1], col=6)
plot(a[,3]~a[,2], col=1)
points(a[,4]~a[,2], col=2)
points(a[,5]~a[,2], col=3)
points(a[,6]~a[,2], col=4)
points(a[,7]~a[,2], col=5)
rec<-rec[,-c(1,10)]
# Records
rec<-read.csv("records.csv", header=T)
rec
pca.voc <- princomp(cov = voc)
summary(pca.voc)
pca.voc$loadings
voca <- voc
voca_u<-eigen(voca)$vectors
voca_lam<-eigen(voca)$values
voca_lam
plot(voca_lam, type="l")
points(voca_lam)
voca_lam
vox
voc
voca_u<-eigen(voca)$vectors
voca_lam<-eigen(voca)$values
voca_lam
plot(voca_lam, type="l")
points(voca_lam)
loadings_voca<-voca_u%*%diag(sqrt(voca_lam))
loadings_voca
round(loadings_voca,2<0
round(loadings_voca,2)
round(loadings_voca,2)
redim<-voca_u[,1:7]
redim
a<-loadings_voca[,1:7]
plot(a[,2]~a[,1], xlim=c(-1, 0.5), col=1)
abline(v=0, h=0)
points(a[,3]~a[,1], col=2)
points(a[,4]~a[,1], col=3)
points(a[,6]~a[,1], col=5)
points(a[,7]~a[,1], col=6)
points(a[,5]~a[,1], col=4)
plot(a[,3]~a[,2], col=1)
points(a[,5]~a[,2], col=3)
points(a[,4]~a[,2], col=2)
points(a[,6]~a[,2], col=4)
points(a[,7]~a[,2], col=5)
pca.voc <- princomp(cov = voc)
summary(pca.voc)
pca.voc$loadings
round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
round(eigen(voc)$value^2/sum(eigen(voc)$value^2),2)
summary(pca.voc)
pca.voc$loadings
pca.voc$loadings[,1:10]
plot(pca.voc$loadings[,1], pca.voc$loadings[,2])
text(pca.voc$loadings[,1], pca.voc$loadings[,2], labels = rownames(pca.voc$loadings))
abline(h=0, v=0)
summary(pca.voc)
round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
m <- round(eigen(voc)$value^2/sum(eigen(voc)$value^2),2)
m
ms <- abs(m)>0.25
ms
m
m <- round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
m
ms <- abs(m)>0.25
ms
m
ms <- abs(m)>0.5
ms
ms <- abs(m)>0.5
ms
ms <- abs(m)>0.6
ms
ms <- abs(m)>0.55
ms
ms <- abs(m)>0.6
ms
m
ms <- abs(m)>0.55
ms
ms <- abs(m)>0.55
ms
m
m <- round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
m
ms <- abs(m[1:6])>0.55
ms
ms <- abs(m[,1:6])>0.55
ms
ms <- abs(m[,1:6])>0.4
ms
ms <- abs(m[,1:6])>0.45
ms
ms <- abs(m[,1:6])>0.40
ms
apply(pca.voc$loadings**2, 2, sum)
apply(m**2, 2, sum)
round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)
round(eigen(voc)$value^2/sum(eigen(voc)$value^2),2)
eigen(voc)$value^2
eigen(voc)$value
ms <- abs(m[,1:6])>0.40
ms
ms <- abs(m[,1:6])>0.50
ms
?princomp
princomp
ms
ms
m
m <- round(eigen(voc)$vectors%*%sqrt(diag(eigen(voc)$value)),2)[1:7]
plot(pca.voc$loadings[,1], pca.voc$loadings[,2])
text(pca.voc$loadings[,1], pca.voc$loadings[,2], labels = rownames(pca.voc$loadings))
efa2 <- factanal(cov=gov, factors=2,rotation="promax")
efa2
communality <- apply(efa2$loadings**2, 1, sum) ; communality
communality <- apply(efa2$loadings**2, 1, sum) ; communality
B <- solve(cog) %*% matrix(cfa3$coeff[1:18], 18, 1)
#6.8
cog <- read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/COGNITION.txt")
cog <- cog[,-1]
temp<-0
rows<-numeric()
for(i in 1:201){
if(sum(cog[i,]==".")>=1) {
temp <- temp+1
rows[temp] <- i
}
}
cog <- cog[-rows,]
for(i in 1:18){
cog[,i] <- as.numeric(cog[,i])
}
#(a)
cov_cog <- cov(cog)
dimnames(cov_cog) <- list(paste("X", 1:18, sep = ""),paste("X", 1:18, sep = ""))
corrplot(cor(cov_cog))
model1 <- specifyModel()
library("tools")
library("HSAUR2")
library("MVA")
library("sem")
#Model
options(fit.indices=c("GFI", "AGFI", "RMSEA", "AIC", "BIC", "CAIC"))
#model test
cfa3 <- sem(model1, S=cov_cog, N=195)
#(a)
cov_cog <- cov(cog)
dimnames(cov_cog) <- list(paste("X", 1:18, sep = ""),paste("X", 1:18, sep = ""))
corrplot(cor(cov_cog))
model1 <- specifyModel()
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
pathDiagram(cfa3, style="ram", ignore.double = FALSE, edge.labels="values")
a<-sum(cfa3$coeff[1:18])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
pc2
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cfa3$coeff[1:18]
B <- solve(cog) %*% matrix(cfa3$coeff[1:18], 18, 1)
B <- solve(cov_cog) %*% matrix(cfa3$coeff[1:18], 18, 1)
B
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cog
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
#model test
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
#(b)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
#(b)
cor(cog)
summary(cfa3)
a<-sum(cfa3$coeff[1:18])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
pc2
#(b)
cor(cog)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cfa3$coeff[1:18]
B <- solve(cov_cog) %*% matrix(cfa3$coeff[1:18], 18, 1)
B
B <- solve(cor(cog)) %*% matrix(cfa3$coeff[1:18], 18, 1)
B
#(b)
cor(cog)
#6.8
cog <- read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch04/COGNITION.txt")
cog <- cog[,-1]
temp<-0
rows<-numeric()
for(i in 1:201){
if(sum(cog[i,]==".")>=1) {
temp <- temp+1
rows[temp] <- i
}
}
cog <- cog[-rows,]
for(i in 1:18){
cog[,i] <- as.numeric(cog[,i])
}
#(a)
cov_cog <- cov(cog)
dimnames(cov_cog) <- list(paste("X", 1:18, sep = ""),paste("X", 1:18, sep = ""))
corrplot(cor(cov_cog))
model1 <- specifyModel()
cfa3 <- sem(model1, S=cov_cog, N=195)
summary(cfa3)
pathDiagram(cfa3, style="ram", ignore.double = FALSE, edge.labels="values")
a<-sum(cfa3$coeff[1:18])
b<-sum(cfa3$coeff[19:36]^2)
pc2 <- a^2/(a^2+b)
pc2
#(b)
cor(cog)
solve(cor(cog))%*%matrix(cfa3$coeff[1:18],18,1)
cfa3$coeff[1:18]
AT
# 6.4
AT <- data.matrix(read.table("C:/Users/pkmon/Desktop/19-1/다변량/DATA/Ch06/ATTITUDE.txt", fill =T, col.names = paste("X", 1:6)))
AT[upper.tri(AT)] <- t(AT)[upper.tri(AT)]
dimnames(AT) <- list(paste("X", 1:6, sep=""), paste("X", 1:6, sep=""))
AT
#(A)
model1 <- specifyModel()
cfa1 <- sem(model1, S=AT, N=100)
summary(cfa1)
covx <- matrix(c(1, -2, 0, -2 ,5, 0, 0, 0, 2), 3)
cov
covx
u <- matrix(c(.383, -0.924, 0, 0, 0, 1, 0.924, 0), 3)
u
u <- matrix(c(.383, -0.924, 0, 0, 0, 1, 0.924, 0.383, 0), 3)
eig<-diag(c(5.83, 2, 0.17))
eig
covx%*%u
covx%*%u%*%dig(sqrt(eig))
covx%*%u%*%diag(sqrt(eig))
covx%*%u
var(covx%*%u[,1)]
var(covx%*%u[,1])]
var(covx%*%u[,1])
var(covx%*%u%*%diag(eig)[,1])
diag(eig)
eig<-matrix(c(5.83, 0 ,0 , 0, 2, 0, 0, 0, 0.17)
eig<-matrix(c(5.83, 0 ,0 , 0, 2, 0, 0, 0, 0.17))
eig<-matrix(c(5.83, 0 ,0 , 0, 2, 0, 0, 0, 0.17))
var((covx%*%u%*%eig)[,1])
eig
eig<-matrix(c(5.83, 0 ,0 , 0, 2, 0, 0, 0, 0.17),3)
var((covx%*%u%*%eig)[,1])
eig
var((covx%*%u%*%sqrt(eig))[,1])
covx%*%u%*%sqrt(eig)
covx%*%u%*%(sqrt(eig)^-1)
covx%*%u%*%sqrt(eig^-1)
eig^-1
a<-(c(5.83, 0 ,0 , 0, 2, 0, 0, 0, 0.17))^-1
a
a<-c(5.83 2, 0.17)
a<-c(5.83, 2, 0.17)
diag(a)
var((covx%*%u%*%sqrt(diag(a)))[,1])
a
diag(A)
diag(a)
sqrt(diag(a))
covx%*%u%*%sqrt(diag(a))
covx%*%u%*%sqrt(diag(a^-1))
var(covx)
cor(covx)
corx <- matrix(c(1, -0.894, 0, -0.894 ,1, 0, 0, 0, 1), 3)
corx
corx%*%u
cor(covx)
corx%*%u%*%sqrt(diag(a^-1))
lambda<-c(0.6927, 0.8621, 0.8433, 0.9138, 0.7695 0.7514, 0.5618, 0.6660)
lambda<-c(0.6927, 0.8621, 0.8433, 0.9138, 0.7695, 0.7514, 0.5618, 0.6660)
1-lambda^2
sum(lambda)^2 + sum(1-lambda^2)
sum(lambda)^2/(sum(lambda)^2 + sum(1-lambda^2))
(sum(lambda)^2)/(sum(lambda)^2 + sum(1-lambda^2))
(sum(lambda^2))/(sum(lambda^2) + sum(1-lambda^2))
lambda<-c(0.8433, 0.9138, 0.7695, 0.7514, 0.5618, 0.6660)
(sum(lambda)^2)/(sum(lambda)^2 + sum(1-lambda^2))
