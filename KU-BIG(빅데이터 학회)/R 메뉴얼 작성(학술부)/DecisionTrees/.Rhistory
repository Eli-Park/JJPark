getwd()
mush <-read.table(paste(getwd(),"/mushroom.txt"))
mush <-read.table(paste(getwd(),"/mushroom.txt",sep=""))
View(mush)
mush <-read.csv(paste(getwd(),"/mushroom.txt",sep=""))
View(mush)
mush <-read.csv(paste(getwd(),"/mushroom.txt",sep=""), header=FALSE)
View(mush)
str(mush)
#install.packages("tree")
library(tree)
fit = tree(v1 ~., data=mush, split="deviance")
fit = tree(V1 ~., data=mush, split="deviance")
fit
summary(fit)
plot(fit);  text(fit)
colnames(mush) <- c("type", "cap-shape", "cap-surface", "cap-color", "bruises", "odor", "gill-attachment", "gill-spacing", "gill-size",
"gill-color", "stalk-shape", "stalk-root", "stalk-surface-above-ring", "stalk-surface-below-ring", "stalk-color-above-ring",
"stalk-color-below-ring", "veil-type", "veil-color", "ring-number", "ring-type", "spore-print-color", "population", "habitat")
View(mush)
?write.csv
write.csv(mush, file = "mush.csv")
cv.fit = cv.tree(fit, FUN=prune.misclass)
fit = tree(type ~., data=mush, split="deviance")
fit = tree(type ~., data=mush, split="deviance")
View(mush)
str(mush)
fit = tree(type~., data=mush, split="deviance")
fit = tree(type~., data=mush, split="deviance")
fit = tree(type ~., data=mush, split="deviance")
fit = tree(V1 ~., data=mush, split="deviance")
str(mush)
fit = tree(type ~., data=mush, split="deviance")
fit = tree(mush[,1] ~., data=mush, split="deviance")
mush <-read.csv(paste(getwd(),"/mushroom.txt",sep=""), header=FALSE)
fit = tree(mush[,1] ~., data=mush, split="deviance")
fit
summary(fit)
plot(fit);  text(fit)
cv.fit = cv.tree(fit, FUN=prune.misclass)
View(mush)
fit = tree(mush[,1] ~., data=mush, split="deviance")
fit
summary(fit)
plot(fit);  text(fit)
fit = tree(V1 ~., data=mush, split="deviance")
fit
summary(fit)
plot(fit);  text(fit)
cv.fit = cv.tree(fit, FUN=prune.misclass)
names(cv.fit)
cv.fit
mush <-read.csv(paste(getwd(),"/mushroom.txt",sep=""), header=FALSE)
colnames(mush) <- c("type", "cap-shape", "cap-surface", "cap-color", "bruises", "odor", "gill-attachment", "gill-spacing", "gill-size",
"gill-color", "stalk-shape", "stalk-root", "stalk-surface-above-ring", "stalk-surface-below-ring", "stalk-color-above-ring",
"stalk-color-below-ring", "veil-type", "veil-color", "ring-number", "ring-type", "spore-print-color", "population", "habitat")
View(mush)
fit = tree(type ~., data=mush, split="deviance")
mush <-read.csv(mush.csv)
mush <-read.csv(paste(getwd(),"/mush.csv",sep="")
)
View(mush)
?write.csv
write.csv(mush, file = "mush.csv", row.names = FALSE)
mush <-read.csv(paste(getwd(),"/mush.csv",sep="")
mush <-read.csv(paste(getwd(),"/mush.csv",sep="")
)
mush <-read.csv(paste(getwd(),"/mush.csv",sep=""))
View(mush)
write.csv(mush, file = "mush.csv", row.names = FALSE)
mush <-read.csv(paste(getwd(),"/mush.csv",sep=""))
View(mush)
mush <-read.csv(paste(getwd(),"/mushroom.txt",sep=""), header=FALSE)
colnames(mush) <- c("type", "cap-shape", "cap-surface", "cap-color", "bruises", "odor", "gill-attachment", "gill-spacing", "gill-size",
"gill-color", "stalk-shape", "stalk-root", "stalk-surface-above-ring", "stalk-surface-below-ring", "stalk-color-above-ring",
"stalk-color-below-ring", "veil-type", "veil-color", "ring-number", "ring-type", "spore-print-color", "population", "habitat")
write.csv(mush, file = "mush.csv", row.names = FALSE)
mush <-read.csv(paste(getwd(),"/mush.csv",sep=""))
View(mush)
fit = tree(type ~., data=mush, split="deviance")
fit
summary(fit)
plot(fit);  text(fit)
cv.fit = cv.tree(fit, FUN=prune.misclass)
names(cv.fit)
cv.fit
par(mfrow=c(2,2))
plot(cv.fit$size,cv.fit$dev, type="b")
plot(cv.fit$k,cv.fit$dev, type="b")
fit.pruned = prune.misclass(fit, best=5)
plot(fit.pruned);text(fit.pruned)
fit.pruned = prune.misclass(fit, best=cv.fit$size[which.min(cv.fit$dev)])
plot(fit.pruned);text(fit.pruned)
### Prediction
pred = predict(fit.pruned, newdata=iris, type="class") #prediction
### Prediction
pred = predict(fit.pruned, newdata=mush, type="class") #prediction
ctable = table(iris$variety, pred, dnn=c("Actual", "Predicted")); ctable #classification table
ctable = table(mush$type, pred, dnn=c("Actual", "Predicted")); ctable #classification table
miss.err = 1-sum(diag(ctable))/sum(ctable); miss.err # Misclassification Rate
pred.acc = 1 - miss.err; pred.acc #Prediction Accuracy
set.seed(123)
V = 2
n =  nrow(mush)
id = sample(1:V, n, prob = c(0.7,0.3), replace = T) # Partitioning 7:3
ii = which(id==1)
iris.train = mush[ii,]
iris.test  = mush[-ii,]
fit = tree(variety ~., iris.train)
fit = tree(type ~., iris.train)
fit
summary(fit)
plot(fit);  text(fit)
set.seed(3)
cv.fit = cv.tree(fit, FUN=prune.misclass)
names(cv.fit)
cv.fit
par(mfrow=c(2,2))
plot(cv.fit$size,cv.fit$dev, type="b")
plot(cv.fit$k,cv.fit$dev, type="b")
fit.pruned = prune.misclass(fit, best=cv.fit$size[which.min(cv.fit$dev)])
plot(fit.pruned);text(fit.pruned)
pred = predict(fit.pruned, newdata=iris.test, type="class") #prediction
ctable = table(iris.test$variety, pred, dnn=c("Actual", "Predicted"));
ctable #classification table
mush <-read.csv(paste(getwd(),"/mush.csv",sep=""))
View(mush)
